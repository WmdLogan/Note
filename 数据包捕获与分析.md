# 数据包捕获与分析

## 数据链路层

#### 以太网帧（Ethernet Frame）

首部固定长度：**14 字节**

1. **6字节** ： 目的MAC地址
2. **6字节 **： 源MAC地址
3. **2字节** ： 网络层协议类型
   - 0x0800 ： IP协议
   - 0x0806 ： ARP协议
   - 0x0835 ： RARP协议

Mac地址前**3**个字节 ： 供应商代码， 后**3**个字节 ： 供应商分配代码

以太网帧在物理层转换成比特流

## 网络层

### IP数据报（IPv4）

首部固定长度（**20字节**） + 可变长度 + 数据部分

首部固定长度：**4bit**版本 + **4bit**首部长度（**单位是4字节**，即1111表示15 * 4 = 60字节） + **8bit**服务类型 +

​						**16bit** 总长度（即首部长度 + 数据部分长度，单位为**1字节**，包括帧的头部不能超过65535(MTU)）

​						**16bit**标识 + **3bit**标志位 + **13bit**偏移长度

​						**8bit**生存时间+ **8bit**协议+ **16bit**首部校验和

​						**32bit**源地址 + **32bit**目的地址

可变字段：用来支持安全、排错以及测量等措施，增加IP数据报的功能。不管有几项都一个一个拼起来，中间不需要分隔符，最后用0填充为4的整数倍。		

### IP数据报（IPv6）

首部固定长度（**40字节**） + 可变长度 + 数据部分

地址为128bit， 最大传输单元仍为65535

## 传输层

### TCP数据包

首部固定长度（**20字节**） + 可变长度 + 数据部分（可选，即TCP数据包可以不包含数据，如三次握手和四次挥手）

首部固定长度 ：**16bit**源端口 + **16bit**目的端口

​						**32bit**序号 + **32bit**确认号(包含发送确认的一端所期望收到的下一个序号。只有在ACK标志为1时才有效)

​						**4bit**首部长度+ **6bit**保留位 + **1bit**：URG ACK PSH RST SYN FIN + **16bit**窗口

​						**16bit**检验和 + **16bit**紧急指针

​						选项（**0 ~ 40 字节**） + 填充

### UDP数据包

首部（**8字节**） + 数据部分

首部：**16bit**源端口 + **16bit**目的端口

​		**16bit**UDP长度 + **16bit**UDP检验和







